{% extends 'base.html' %}
{% block title %}FootyForecast{% endblock %}
{% block content %}
  <div class="hero">
    <div class="hero-inner">
      <h1>Головні новини</h1>
      <div class="grid cols-2">
        <div style="position:relative;">
          {% if featured and featured|length > 0 %}
          <a href="{% url 'news_detail' featured.0.slug %}" style="display:block;position:relative;overflow:hidden;border-radius:16px;">
            {% if featured.0.image_url %}
            <img src="{{ featured.0.image_url }}" alt="{{ featured.0.title }}" style="width:100%;height:320px;object-fit:cover;border-radius:16px;" />
            <div style="position:absolute;bottom:0;left:0;right:0;background:linear-gradient(to top, rgba(10,25,41,0.95) 0%, transparent 100%);padding:24px;">
              <h2 class="title" style="margin:0 0 8px;color:white;">{{ featured.0.title }}</h2>
              <p class="muted" style="margin:0;color:rgba(255,255,255,0.8);">{{ featured.0.summary }}</p>
            </div>
            {% else %}
            <h2 class="title" style="margin-top:8px;">{{ featured.0.title }}</h2>
            <p class="muted">{{ featured.0.summary }}</p>
            {% endif %}
          </a>
          {% else %}
          <div class="muted">Додайте featured-новину в адмінці</div>
          {% endif %}
        </div>
        <div>
          <div class="section-title">Популярне зараз</div>
          <ul class="list">
            {% for n in featured %}
            <li><a href="{% url 'news_detail' n.slug %}">{{ n.title }}</a></li>
            {% empty %}
            <li class="muted">Немає даних</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="card" style="margin-bottom:20px;">
    <div class="section-title">Пошук</div>
    <form method="get" style="display:flex;gap:12px;align-items:center;">
      <input type="text" name="q" value="{{ q }}" placeholder="Команда або ліга" style="flex:1;" />
      <button type="submit">Знайти</button>
    </form>
  </div>

  <div class="grid cols-2">
    <div class="card">
      <div class="section-title">Ліги</div>
      <ul class="list">
        {% for l in leagues %}
        <li><a href="{% url 'league_detail' l.id %}">{{ l.name }}</a></li>
        {% empty %}
        <li class="muted">Немає ліг</li>
        {% endfor %}
      </ul>
    </div>
    <div class="card">
      <div class="section-title">Найближчі матчі</div>
      <ul class="list">
        {% for m in upcoming %}
        <li>
          <a href="{% url 'match_detail' m.id %}">{{ m.home_team }} vs {{ m.away_team }}</a>
          <div class="muted">{{ m.date_utc|date:"Y-m-d H:i" }} • {{ m.league.name }}</div>
          {% if m.forecast %}
          <div class="badges">
            <span class="badge prob">1 {{ m.forecast.prob_home|floatformat:2 }}</span>
            <span class="badge prob">X {{ m.forecast.prob_draw|floatformat:2 }}</span>
            <span class="badge prob">2 {{ m.forecast.prob_away|floatformat:2 }}</span>
            {% with maxp=m.forecast.prob_home|floatformat:4 %}{% endwith %}
            {% if m.forecast.confidence == 'high' %}<span class="badge ok">Фаворит</span>{% endif %}
          </div>
          {% endif %}
        </li>
        {% empty %}
        <li class="muted">Найближчих матчів немає</li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="card" style="margin-top:20px;">
    <div class="section-title">Останні новини</div>
    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:20px;">
      {% for n in latest_news %}
      <a class="card" href="{% url 'news_detail' n.slug %}" style="display:block;padding:0;overflow:hidden;">
        {% if n.image_url %}
        <img src="{{ n.image_url }}" alt="{{ n.title }}" style="width:100%;height:180px;object-fit:cover;border-radius:16px 16px 0 0;" />
        {% endif %}
        <div style="padding:16px;">
          <div class="section-title" style="margin:0 0 8px;font-size:16px;padding-left:0;">{{ n.title }}</div>
          <div class="muted">{{ n.created_at|date:"Y-m-d H:i" }}{% if n.league %} • {{ n.league.name }}{% endif %}</div>
        </div>
      </a>
      {% empty %}
      <div class="muted">Немає новин</div>
      {% endfor %}
    </div>
  </div>
{% endblock %}

